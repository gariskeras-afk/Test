<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kuis Tebak Lagu Hits YouTube üé∂</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap');
        
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #1c1c3a 0%, #0a0a1e 100%);
            color: #ecf0f1;
            padding: 20px;
            text-align: center;
            min-height: 100vh;
        }
        #quiz-box {
            max-width: 600px;
            margin: 30px auto;
            background-color: #2c3e50;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        }
        h1 {
            color: #ff6b6b;
            margin-bottom: 20px;
            text-shadow: 0 0 5px rgba(255, 107, 107, 0.5);
        }
        #question-display {
            font-size: 1.2em;
            margin-bottom: 20px;
            font-weight: 600;
            background-color: #1e3040;
            padding: 15px;
            border-radius: 8px;
            border-left: 5px solid #ff6b6b;
        }
        #youtube-player-container {
            width: 100%;
            aspect-ratio: 16 / 9; 
            margin-bottom: 20px;
            display: none; 
            border-radius: 8px;
            overflow: hidden;
        }
        .option-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1.1em;
            transition: background-color 0.2s;
            border: 1px solid #34495e;
            background-color: #34495e;
            color: white;
            text-align: left;
        }
        .option-button:hover:not(:disabled) {
            background-color: #4a637d;
        }
        #result-display {
            margin-top: 20px;
            font-size: 1.2em;
            font-weight: 600;
        }
        #start-button, #next-button, #telegram-share-button {
            padding: 12px 25px;
            margin: 10px 5px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            font-size: 1em;
        }
        #start-button { background-color: #2ecc71; color: white; }
        #next-button { background-color: #3498db; color: white; display: none; }
        #telegram-share-button { background-color: #0088cc; color: white; display: none; }
    </style>
</head>
<body>
    <div id="quiz-box">
        <h1>üéß Kuis Tebak Lagu Viral 2020-2025 üéß</h1>
        <p>Tebak lagu hits dari klip video YouTube tersembunyi!</p>
        
        <div id="youtube-player-container">
            <div id="youtube-player"></div>
        </div>
        
        <div id="question-display">Klik "Mulai Kuis" untuk memulai tantangan tebak lagu ini!</div>
        <div id="options-container"></div>
        <div id="result-display"></div>
        
        <button id="start-button">Mulai Kuis</button>
        <button id="next-button">Lanjut Pertanyaan</button>
        <button id="telegram-share-button">Bagikan Skor ke @GW_GK</button>
    </div>

    <script src="https://www.youtube.com/iframe_api"></script>

    <script>
        // --- DATA PERTANYAAN (GUNAKAN ARRAY UNTUK MULTI-ID) ---
        const questions = [
            {
                q: "Dengarkan klip ini. Lagu hits pop Mahalini yang rilis 2023 ini berjudul:",
                // Masukkan beberapa ID. Sistem akan mencoba ID pertama, jika error akan mencoba yang kedua, dst.
                youtubeIds: ["AzHjARa84bI", "vB8k5tJ8-u0"], // Lirik/Karaoke lebih dulu
                currentIdIndex: 0, // Indeks ID yang sedang dicoba
                options: ["Komang", "Sial", "Tertawan Hati", "Hati-Hati di Jalan"],
                answer: "Sial",
                startTime: 10, 
                duration: 5    
            },
            {
                q: "Ini adalah salah satu 'sound' paling viral di TikTok tahun 2023. Judul lagunya adalah:",
                youtubeIds: ["wIo9gS0EKhE", "Tzzdu68zbvQ"], // Lirik/Cover lebih dulu
                currentIdIndex: 0,
                options: ["Rungkad", "Glimpse of Us", "Asmalibrasi", "Ayam Jago"],
                answer: "Rungkad",
                startTime: 5, 
                duration: 7    
            },
            {
                q: "Lagu dari Danar Widianto yang viral kembali karena dipakai di film horor:",
                youtubeIds: ["RY1zQHjUG_Q", "pz9bGfyVlXQ"], 
                currentIdIndex: 0,
                options: ["Kisah Klasik", "Dulu", "Bertahan", "Menghapus Jejakmu"],
                answer: "Dulu",
                startTime: 20, 
                duration: 6    
            }
        ];

        
        const qDisplay = document.getElementById('question-display');
        const optionsContainer = document.getElementById('options-container');
        const resultDisplay = document.getElementById('result-display');
        const startButton = document.getElementById('start-button');
        const nextButton = document.getElementById('next-button');
        const telegramButton = document.getElementById('telegram-share-button');
        const playerContainer = document.getElementById('youtube-player-container');
        
        let currentQuestionIndex = 0;
        let score = 0;
        let player;
        let stopPlaybackTimeout;
        let playAgainButton;

        // --- HANDLER ERROR PLAYER YOUTUBE (Auto-ganti ID jika error) ---
        function onPlayerError(event) {
            const q = questions[currentQuestionIndex];
            
            // Coba ID berikutnya
            q.currentIdIndex++;

            if (q.currentIdIndex < q.youtubeIds.length) {
                // Ada ID alternatif, coba muat ID berikutnya
                resultDisplay.innerHTML = `<span style="color: #f39c12;">‚ö†Ô∏è Video Soal ${currentQuestionIndex + 1} Gagal Dimuat. Mencoba ID Alternatif (${q.currentIdIndex + 1}/${q.youtubeIds.length})...</span>`;
                console.warn(`Error code ${event.data}. Trying next ID: ${q.youtubeIds[q.currentIdIndex]}`);
                
                // Muat ulang video dengan ID berikutnya
                setTimeout(() => {
                    player.loadVideoById(q.youtubeIds[q.currentIdIndex], q.startTime);
                    playClue();
                }, 1000); 

            } else {
                // Semua ID gagal
                console.error("Semua ID video gagal dimuat:", q.youtubeIds);
                resultDisplay.innerHTML = `<span style="color: #e74c3c;">‚ùå Error: Semua Video Soal ${currentQuestionIndex + 1} Gagal Dimuat. Otomatis Ganti Soal...</span>`;
                
                // Pindah ke soal berikutnya
                setTimeout(() => {
                    currentQuestionIndex++;
                    loadQuestion();
                }, 2000); 
            }
        }
        
        // --- Fungsi API YouTube Player ---
        function onYouTubeIframeAPIReady() {
            player = new YT.Player('youtube-player', {
                height: '100%',
                width: '100%',
                videoId: '',
                playerVars: {
                    'playsinline': 1,
                    'controls': 1, 
                    'disablekb': 1,
                    'rel': 0, 
                    'modestbranding': 1,
                    'autoplay': 1,  
                    'mute': 1       
                },
                events: {
                    'onReady': onPlayerReady,
                    'onStateChange': onPlayerStateChange,
                    'onError': onPlayerError 
                }
            });
        }
        
        function onPlayerReady(event) {
            startButton.disabled = false;
        }

        function onPlayerStateChange(event) {
            if (event.data === YT.PlayerState.PLAYING) {
                const q = questions[currentQuestionIndex];
                clearTimeout(stopPlaybackTimeout);
                
                stopPlaybackTimeout = setTimeout(() => {
                    player.stopVideo();
                    player.seekTo(q.startTime, true); 
                    if(playAgainButton) playAgainButton.textContent = 'üîä Putar Ulang Klip';
                }, q.duration * 1000); 
            }
        }
        
        // --- Fungsi Kontrol Pemutaran ---
        function playClue() {
            if (!player || currentQuestionIndex >= questions.length || startButton.style.display !== 'none') return;
            
            const q = questions[currentQuestionIndex];
            
            clearTimeout(stopPlaybackTimeout);
            
            // Dapatkan ID video yang sedang dicoba
            const videoId = q.youtubeIds[q.currentIdIndex];

            if (player.getVideoData().video_id !== videoId) {
                player.loadVideoById(videoId, q.startTime);
            } else {
                player.seekTo(q.startTime, true);
                player.playVideo();
            }
            if(playAgainButton) playAgainButton.textContent = '‚ñ∂Ô∏è Memutar...';
            
            resultDisplay.innerHTML = '<span style="color: #f1c40f; font-size: 0.9em;">‚ö†Ô∏è Jika tidak ada suara, klik tombol Mute/Volume di player di atas!</span>';
        }

        // --- Fungsi Utama Game ---
        function startGame() {
            currentQuestionIndex = 0;
            score = 0;
            startButton.style.display = 'none';
            telegramButton.style.display = 'none';
            resultDisplay.textContent = '';
            playerContainer.style.display = 'block'; 
            
            // Reset semua indeks video yang dicoba
            questions.forEach(q => q.currentIdIndex = 0);
            
            const firstQ = questions[0];
            player.loadVideoById(firstQ.youtubeIds[0], firstQ.startTime);
            
            setTimeout(loadQuestion, 500); 
        }

        function loadQuestion() {
            if (currentQuestionIndex >= questions.length) {
                showFinalResult();
                return;
            }
            
            const q = questions[currentQuestionIndex];
            
            qDisplay.innerHTML = `<strong>Soal ${currentQuestionIndex + 1}:</strong> ${q.q}`;
            optionsContainer.innerHTML = '';
            nextButton.style.display = 'none';
            
            // Muat video pertama (atau video yang terakhir dicoba jika error)
            player.loadVideoById(q.youtubeIds[q.currentIdIndex], q.startTime);
            
            q.options.forEach(option => {
                const button = document.createElement('button');
                button.textContent = option;
                button.classList.add('option-button');
                button.addEventListener('click', () => checkAnswer(button, option, q.answer));
                optionsContainer.appendChild(button);
            });
            
            playAgainButton = document.createElement('button');
            playAgainButton.textContent = 'üîä Putar Ulang Klip';
            playAgainButton.style.cssText = 'padding: 10px 20px; background-color: #1abc9c; color: white; border: none; border-radius: 8px; cursor: pointer; margin-bottom: 15px;';
            playAgainButton.addEventListener('click', playClue);
            optionsContainer.insertBefore(playAgainButton, optionsContainer.firstChild);

            playClue();
        }

        function checkAnswer(clickedButton, selectedOption, correctAnswer) {
            Array.from(optionsContainer.children).forEach(btn => btn.disabled = true);
            
            clearTimeout(stopPlaybackTimeout);
            player.stopVideo();
            
            if (selectedOption === correctAnswer) {
                score++;
                resultDisplay.textContent = '‚úÖ Benar! Anda Peka Musik Viral.';
                clickedButton.style.backgroundColor = '#1abc9c';
            } else {
                resultDisplay.innerHTML = `‚ùå Salah! Judul yang benar adalah: **${correctAnswer}**`;
                clickedButton.style.backgroundColor = '#e74c3c';
                Array.from(optionsContainer.children).find(btn => btn.textContent === correctAnswer).style.backgroundColor = '#2ecc71';
            }
            
            nextButton.style.display = 'block';
            nextButton.textContent = currentQuestionIndex < questions.length - 1 ? 'Lanjut Pertanyaan' : 'Lihat Hasil Akhir';
        }

        function showFinalResult() {
            qDisplay.textContent = '--- KUIS SELESAI ---';
            optionsContainer.innerHTML = '';
            nextButton.style.display = 'none';
            playerContainer.style.display = 'none';
            resultDisplay.textContent = ''; 

            let finalStatus = (score === questions.length) ? 'ü•á MUSIKOLOG VIRAL SEJATI!' : 'üéß Masih Perlu Banyak Mendengar Lagu Hits.';
            
            resultDisplay.innerHTML = `
                Total skormu: <span style="color:#ff6b6b; font-size:1.5em;">${score}</span> dari ${questions.length}.
                <br><br><span style="color:#2ecc71;">${finalStatus}</span>
            `;
            
            startButton.textContent = 'Ulangi Kuis';
            startButton.style.display = 'block';
            telegramButton.style.display = 'block';
        }

        function shareTelegram() {
            const finalStatus = (score === questions.length) ? 'MUSIKOLOG VIRAL SEJATI' : 'Perlu Banyak Mendengar Lagu Hits';
            const shareMessage = `Aku menyelesaikan Kuis Tebak Lagu Viral (YouTube) dengan skor ${score}/${questions.length}! Aku adalah ${finalStatus}. Coba kamu, @GW_GK!`;
            const url = `https://t.me/GW_GK?text=${encodeURIComponent(shareMessage)}`;
            window.open(url, '_blank');
        }

        startButton.addEventListener('click', startGame);
        nextButton.addEventListener('click', () => { currentQuestionIndex++; loadQuestion(); });
        telegramButton.addEventListener('click', shareTelegram);

        optionsContainer.innerHTML = '<p style="color:#bdc3c7;">Player YouTube harus siap sebelum tombol "Mulai Kuis" aktif. Tunggu sebentar...</p>';
        startButton.disabled = true;
    </script>
</body>
</html>
